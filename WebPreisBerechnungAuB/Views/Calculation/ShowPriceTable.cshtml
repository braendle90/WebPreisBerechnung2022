@using System.Globalization
@model IEnumerable<WebPreisBerechnungAuB.Models.CalculationVM>

@{
    ViewData["Title"] = "ShowTable";
    var test = Model;
    int count = 0;
}

<style>
    .hiddenRow {
        padding: 0 !important;
    }

    thead tr {
        border-bottom: 10px solid white;
    }

    .iconsStyle {
        font-size: 1.5rem;
        color: black;
    }
</style>

<div class="text-center mb-5">

    <h1>Kalkulierter Preis</h1>

</div>




<table class="table table-hover  text-nowrap" style="border-collapse:collapse;">

    <thead >
        <tr class="accordion-toggle">


            <th class="col">@Html.DisplayNameFor(m => m.FirstOrDefault().OrderPositionLogo.Order.Textil.TextilName)</th>
            <th class="col">@Html.DisplayNameFor(m => m.FirstOrDefault().OrderPositionLogo.Order.TextilColor.TextilColorName)</th>
            <th class="col">@Html.DisplayNameFor(m => m.FirstOrDefault().OrderPositionLogo.Order.NumberOfPieces)</th>
            <th class="col">@Html.DisplayNameFor(m => m.FirstOrDefault().OrderPositionLogo.Order.PriceScreenPrint)</th>
            @*             <th class="col">@Html.DisplayNameFor(m => m.FirstOrDefault().OrderPositionLogo.Order.OfferId)</th>*@
            <th class="col">Edit</th>


        </tr>
    </thead>


    @foreach (var item in Model)
    {
        <tbody class=" mb-4">

            <tr>
                <td>    </td>
            </tr>

            <tr data-toggle="collapse" data-target="#client_@count" class=" pb-5 pt-5   bg-primary text-white accordion-toggle">

                <td class="col .bg-success">@item.OrderPositionLogo.Order.Textil.TextilName</td>
                <td class="col">@item.OrderPositionLogo.Order.TextilColor.TextilColorName</td>
                <td class="col">@item.OrderPositionLogo.Order.NumberOfPieces</td>
                <td class="col">@item.OrderPositionLogo.Order.PriceScreenPrint</td>
                @*           <td class="col">@item.OrderPositionLogo.Order.OfferId</td>*@

                <td class="col">

                    <a style="font-size: 2rem" onclick="showInPopup('@Url.Action("AddOrEdit","OrderTextil",Context.Request.Scheme)','Texil ändern','@item.OrderPositionLogo.Id','@item.OrderPositionLogo.Order.OfferId')" data-dismiss="modal" class="float-right   bi bi-pencil-square iconsStyle"></a>


                    <form style="font-size: 2rem" asp-action="Delete" asp-route-id="@item.OrderPositionLogo.Id" onclick="return jQueryAjaxDelete(this)" class="float-right text-white bi bi-trash iconsStyle">
                        <input type="hidden" asp-for="@item.OrderPositionLogo.Id" />
                    </form>
                </td>

            </tr>



            <tr class="pb-5 pb-5 hiddenRow">

                <th class="accordian-body collapse show col" id="client_@count">LogoName</th>

                <th class="accordian-body collapse show col" id="client_@count">Quadratzentimeter </th>

                <th class="accordian-body collapse show col" id="client_@count">Position Name</th>

                <th class="accordian-body collapse show col" id="client_@count">Farbanzahl</th>
                <th class="accordian-body collapse show col" id="client_@count">Stückzahl </th>

                <th class="accordian-body collapse show col" id="client_@count">Stückzahl Total</th>

                <th class="accordian-body collapse show col" id="client_@count">Transferpreis</th>

                <th class="accordian-body collapse show col" id="client_@count">Siebdruckpreis</th>



            </tr>


            @foreach (var data in item.ShowPriceModel)
            {
                <tr class="bg-success hiddenRow mr-5 pt5">


                    <td class="accordian-body collapse show col" id="client_@count"> @data.Logo.LogoName</td>

                    <td class="accordian-body collapse show col" id="client_@count"> @data.Logo.LogoSurfaceSize cm²</td>

                    <td class="accordian-body collapse show col" id="client_@count">@data.Position.PositionName</td>

                    <td class="accordian-body collapse show col" id="client_@count">@data.Logo.Color.NumberOfColors Farbig</td>
                    <td class="accordian-body collapse show col" id="client_@count">@data.OrderPositionLogo.Order.NumberOfPieces Stk.</td>

                    <td class="accordian-body collapse show col" id="client_@count">@data.PiecesofTextilWithThisLogo Total Stk.</td>

                    <td class="accordian-body collapse show col" id="client_@count"> á @data.PricePerPicesTransfer.ToString("C", CultureInfo.CurrentCulture)</td>

                    <td class="accordian-body collapse show col" id="client_@count"> á @data.PricePerPices.ToString("C", CultureInfo.CurrentCulture)</td>


                </tr>





                @foreach (var extraCharge in data.extraChargeLists)
                {
                    <tr>

                        <td class="accordian-body collapse show col" id="client_@count">@extraCharge.ExtraCharge.ChargeName</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td class="accordian-body collapse show col" id="client_@count"> á @extraCharge.ExtraCharge.ChargePrice.ToString("C", CultureInfo.CurrentCulture)</td>

                    </tr>

                }


                // total price
                <tr>

                    <th class="accordian-body collapse show col" id="client_@count">Gesamt Preis</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <th class="accordian-body collapse show col" id="client_@count"> á @data.TotalPriceTransfer.ToString("C", CultureInfo.CurrentCulture)</th>
                    <th class="accordian-body collapse show col" id="client_@count"> á @data.TotalPriceScreenPrint.ToString("C", CultureInfo.CurrentCulture)</th>

                </tr>

            }

        </tbody>
        count++;
    }
</table>



<div class="modal" tabindex="-1" role="dialog" id="form-modal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
            </div>
        </div>
    </div>
</div>




<div>

    <div class="float-left">
        <form method="get" asp-action="Index" asp-controller="Position" asp-route-id="@Model.FirstOrDefault().OrderPositionLogo.Order.OfferId">

            <input type="submit" value="Zurück" class="btn btn-primary" />
        </form>

    </div>


    @{

        if (Model.FirstOrDefault().ShowPriceModel.Count() >= 1)
        {
            <div class="text-center">

                <form method="get" asp-action="Index" asp-controller="Calculation" asp-route-id="@Model.FirstOrDefault().OrderPositionLogo.Order.OfferId">

                    <input type="submit" value="Speichern" class="btn btn-primary" />
                </form>


            </div>


        }
    }

</div>



